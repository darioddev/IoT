import{r as S,l as Y,m as $,v as ne,b as i,c as d,t as x,g as w,F as N,j as I,d as e,k as R,f as g,p as D,e as E,q as le,s as re,x as ie,u as de,i as O,y as ce,z as v,A as ue,h as me,B as ve,C as xe,D as G}from"./index-wz-jqVDB.js";import{_ as he}from"./buttonThemeComponet-x-FGUnsb.js";import{g as V,h as B}from"./validations-3worHtu6.js";import{_ as fe}from"./_plugin-vue_export-helper-x3n3nnut.js";import"https://www.gstatic.com/firebasejs/9.6.2/firebase-app.js";import"https://www.gstatic.com/firebasejs/9.6.2/firebase-firestore.js";import"https://www.gstatic.com/firebasejs/9.6.2/firebase-auth.js";const pe=["name","id"],be={key:0,value:"",disabled:"",selected:""},ge=["value"],A={__name:"selectComponent",props:{name:{type:String,required:!0},elementos:{type:Array,required:!0},text:{type:String,required:!1,default:"Selecciona una opción"},selectedValue:{type:String,required:!1,default:""}},setup(m){const{name:f,elementos:u,text:l,selectedValue:n}=m,y=S(n);return Y(()=>n,k=>{y.value=k},{immediate:!0,deep:!0}),(k,j)=>$((i(),d("select",{name:m.name,id:m.name,class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5","onUpdate:modelValue":j[0]||(j[0]=p=>y.value=p)},[m.selectedValue?w("",!0):(i(),d("option",be,x(m.text),1)),(i(!0),d(N,null,I(m.elementos,p=>(i(),d("option",{key:p.name,value:p.name},x(p.name),9,ge))),128))],8,pe)),[[ne,y.value]])}},we={key:0,id:"crud-modal",tabindex:"-1","aria-hidden":"true",class:"flex overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full"},_e={class:"relative p-4 w-full max-w-md max-h-full"},ye={class:"relative bg-white rounded-lg shadow",id:"modal"},ke={class:"flex items-center justify-between p-4 md:p-5 border-b rounded-t"},Se={class:"text-lg font-semibold text-gray-900"},je=e("svg",{class:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14"},[e("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})],-1),Ce=e("span",{class:"sr-only"},"Close modal",-1),Ee=[je,Ce],$e={class:"mb-4"},Me={class:"mb-2"},De={key:0,class:"text-sm font-bold text-red-600 text-center flex items-center justify-center"},Ve=e("svg",{xmlns:"http://www.w3.org/2000/svg",x:"20px",y:"0px",width:"25",height:"25",viewBox:"0 0 48 48",class:""},[e("path",{fill:"#f44336",d:"M44,24c0,11.045-8.955,20-20,20S4,35.045,4,24S12.955,4,24,4S44,12.955,44,24z"}),e("path",{fill:"#fff",d:"M29.656,15.516l2.828,2.828l-14.14,14.14l-2.828-2.828L29.656,15.516z"}),e("path",{fill:"#fff",d:"M32.484,29.656l-2.828,2.828l-14.14-14.14l2.828-2.828L32.484,29.656z"})],-1),Be={key:1,class:"text-sm font-bold text-blue-600 text-center flex items-center justify-center"},Ne=e("svg",{class:"animate-spin -ms-1 w-5 h-5 me-3",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})],-1),Ae={class:"col-span-2 flex items-center justify-between"},Ie=["name","id","placeholder"],ze={class:"col-span-2 flex items-center justify-between pt-2"},Le={type:"submit",class:"text-white inline-flex items-center bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center"},qe=e("svg",{class:"me-1 -ms-1 w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"fill-rule":"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z","clip-rule":"evenodd"})],-1),H={__name:"modalComponent",props:{head:{type:String,required:!0},name:{type:String,required:!0},placeholder:{type:String,required:!1,default:""},elements:{type:Array,required:!0},state:{type:Array,required:!1,default:()=>[]},value:{type:Boolean,required:!1,default:!1},messageError:{type:String,required:!1,default:""},initialData:{type:Object,required:!1,default:()=>({})},isLoading:{type:Object,required:!1}},emits:["closeModal","handleSubmit"],setup(m,{emit:f}){const u=m,l=S({name:"",unit:"",value:"",executor:"",state:""}),n=f,y=()=>n("handleSubmit",l.value),k=()=>n("closeModal",l.value),j=r=>{u.state.length===0?l.value={...l.value,unit:r.target.value}:l.value={...l.value,executor:r.target.value}},p=r=>{l.value={...l.value,state:r.target.value}};return Y(()=>u.initialData,r=>{l.value={...r}},{deep:!0}),(r,b)=>u.value?(i(),d("div",we,[e("div",_e,[e("div",ye,[e("div",ke,[e("h3",Se,x(u.head),1),e("button",{type:"button",class:"text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center","data-modal-toggle":"crud-modal",onClick:k},Ee)]),e("form",{class:"p-4 md:p-5",onSubmit:R(y,["prevent"])},[e("div",$e,[e("div",Me,[u.messageError!==""?(i(),d("p",De,[Ve,g(" "+x(u.messageError),1)])):w("",!0),u.isLoading.load?(i(),d("p",Be,[Ne,g(" "+x(u.isLoading.message),1)])):w("",!0)]),e("div",Ae,[$(e("input",{type:"text",name:u.name,id:u.name,class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 mr-2",placeholder:m.placeholder,"onUpdate:modelValue":b[0]||(b[0]=a=>l.value.name=a)},null,8,Ie),[[D,l.value.name]]),E(A,{name:u.name,elementos:u.elements,onChange:j,selectedValue:l.value.unit||l.value.executor},null,8,["name","elementos","selectedValue"])]),e("div",ze,[u.state.length===0?$((i(),d("input",{key:0,type:"text",name:"value",id:"value",class:"bg-gray-50 border border-gray-300 teaxt-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5",placeholder:"Valor de la unidad","onUpdate:modelValue":b[1]||(b[1]=a=>l.value.value=a)},null,512)),[[D,l.value.value]]):(i(),le(A,{key:1,name:u.name,elementos:u.state,onChange:p,selectedValue:l.value.state,text:"Estado del ejecutor"},null,8,["name","elementos","selectedValue"]))])]),e("button",Le,[qe,g(" "+x(m.head),1)])],32)])])])):w("",!0)}},F=m=>new Promise(f=>{re(m,u=>{f(u.docs.map(l=>({id:l.id,...l.data()})))})}),P={unitName:"units",executorName:"executores",async getUnits(){return await F(this.unitName)},async getExecutors(){return await F(this.executorName)},getLength:m=>Object.keys(m).length,handleSelect:(m,f,u)=>{const l=u.target.selectedOptions[0].value;m[f]=l}},c=m=>(ve("data-v-fbc76d74"),m=m(),xe(),m),Ue={class:"fixed inset-x-0 top-0 z-10 w-full px-4 py-1 bg-white shadow-md border-slate-500 transition duration-700 ease-out"},Oe={class:"flex justify-between p-4"},Te=c(()=>e("div",{class:"text-[2rem] leading-[3rem] tracking-tight font-bold text-black",id:"h1"},[g(" Bienvenido a "),e("span",{class:"text-blue-700"},"IoT")],-1)),He={class:"flex items-center space-x-4 text-lg font-semibold tracking-tight"},Fe=c(()=>e("svg",{class:"w-6 h-6 text-black mx-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"{2}",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1)),Pe=c(()=>e("svg",{class:"w-6 h-6 text-black mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"{2}",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1)),Ye={class:"flex flex-col items-center justify-center w-full h-screen bg-gray-100"},Re={key:0,class:"absolute top-0 left-0 w-full h-full flex items-center justify-center bg-white opacity-75"},Ge=c(()=>e("p",{class:"text-2xl font-bold text-gray-500"},"Cargando...",-1)),Je=[Ge],Ke={key:1},Qe={class:"flex flex-col items-center justify-center w-full h-full"},We=c(()=>e("p",{class:"text-2xl font-bold text-gray-500"},"No tienes ningún espacio",-1)),Xe=c(()=>e("svg",{class:"w-6 h-6 text-black mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"{2}",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1)),Ze={key:2,class:"flex flex-col items-start justify-start h-screen pt-20 w-full"},et={class:"w-full"},tt=c(()=>e("div",{class:"p-4"},[e("p",{class:"text-3xl font-bold text-gray-500"},"Tus espacios")],-1)),st={class:"flex flex-col justify-center w-ful mx-4"},ot={class:"w-full flex rounded-t-lg bg-blue-700 mt-1"},at={class:"text-2xl font-bold text-white p-2"},nt={class:"flex items-center p-1 containerDevice"},lt={class:"text-base font-bold text-white mx-1 underline"},rt={class:"text-base font-bold text-white mx-1 underline"},it=["onClick"],dt=c(()=>e("svg",{class:"w-6 h-6 text-white mr-2 mt-2 rounded-lg cursor-pointer hover:bg-sky-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",title:"Más información sobre el espacio"},[g(" > > "),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"{2}",d:"M19 5l-7 7-7-7"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"{2}",d:"M19 5l-7 7-7-7"})],-1)),ct=[dt],ut={key:0},mt={key:0},vt=G('<div class="flex flex-col items-center justify-center w-full p-2 bg-blue-100 content" data-v-fbc76d74><p class="text-2xl font-bold text-gray-500" data-v-fbc76d74>Sensores </p></div><div class="flex flex-row items-center justify-between w-full pl-4 bg-blue-600" data-v-fbc76d74><div class="flex flex-row items-center justify-between w-full pl-4 bg-blue-600" data-v-fbc76d74><div class="w-1/3" data-v-fbc76d74><p class="text-base font-bold text-white mx-1" data-v-fbc76d74>Nombre</p></div><div class="w-1/3" data-v-fbc76d74><p class="text-base font-bold text-white mx-1" data-v-fbc76d74>Unidad de medida</p></div><div class="w-1/3" data-v-fbc76d74><p class="text-base font-bold text-white mx-1" data-v-fbc76d74>Valor</p></div><div class="w-1/3" data-v-fbc76d74><p class="text-base font-bold text-white mx-1" data-v-fbc76d74></p></div></div></div>',2),xt={class:"w-1/3"},ht={class:"text-base font-medium text-white"},ft={class:"w-1/3 pl-2"},pt={class:"text-base font-medium text-white"},bt={class:"w-1/3 pl-2"},gt={class:"text-base font-medium text-white"},wt={class:"w-1/3"},_t={class:"flex flex-row item-center justify-end p-1 mr-20"},yt=["onClick"],kt=c(()=>e("i",{class:"bx bxs-rename"},null,-1)),St=[kt],jt=["onClick"],Ct=c(()=>e("i",{class:"bx bxs-trash"},null,-1)),Et=[Ct],$t={key:1},Mt=G('<div class="flex flex-col items-center justify-center w-full p-2 bg-blue-100 content" data-v-fbc76d74><p class="text-2xl font-bold text-gray-500" data-v-fbc76d74>Ejecutores</p></div><div class="flex flex-row items-center justify-between w-full pl-4 bg-blue-600" data-v-fbc76d74><div class="flex flex-row items-center justify-between w-full pl-4 bg-blue-600" data-v-fbc76d74><div class="w-1/3" data-v-fbc76d74><p class="text-base font-bold text-white mx-1" data-v-fbc76d74>Nombre</p></div><div class="w-1/3" data-v-fbc76d74><p class="text-base font-bold text-white mx-1" data-v-fbc76d74>Dispositivo</p></div><div class="w-1/3" data-v-fbc76d74><p class="text-base font-bold text-white mx-1" data-v-fbc76d74>Estado</p></div><div class="w-1/3" data-v-fbc76d74><p class="text-base font-bold text-white mx-1" data-v-fbc76d74></p></div></div></div>',2),Dt={class:"w-1/3"},Vt={class:"text-base font-medium text-white"},Bt={class:"w-1/3 pl-2"},Nt={class:"text-base font-medium text-white"},At={class:"w-1/3 pl-2"},It={class:"text-base font-medium text-white"},zt={class:"w-1/3"},Lt={class:"flex flex-row item-center justify-end p-1 mr-20"},qt=["onClick"],Ut=c(()=>e("i",{class:"bx bxs-rename"},null,-1)),Ot=[Ut],Tt=["onClick"],Ht=c(()=>e("i",{class:"bx bxs-trash"},null,-1)),Ft=[Ht],Pt={key:2},Yt=c(()=>e("div",{class:"flex flex-col items-center justify-center w-full p-2 bg-blue-100 content"},[e("p",{class:"text-2xl font-bold text-gray-500"},"Sin sensores ni ejecutores.")],-1)),Rt=[Yt],Gt={class:"flex flex-row bg-blue-700 rounded-b-lg p-3"},Jt=["onClick","id"],Kt=c(()=>e("i",{class:"bx bx-radar bx-sm"},null,-1)),Qt=["onClick"],Wt=c(()=>e("i",{class:"bx bx-devices bx-sm"},null,-1)),Xt=["onClick"],Zt=c(()=>e("i",{class:"bx bxs-trash text-lg mr-1"},null,-1)),es={key:3,id:"crud-modal",tabindex:"-1","aria-hidden":"true",class:"flex overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full"},ts={class:"relative p-4 w-full max-w-md max-h-full"},ss={class:"relative bg-white rounded-lg shadow",id:"modal"},os=c(()=>e("h3",{class:"text-lg font-semibold text-gray-900"}," Crear un nuevo espacio ",-1)),as=c(()=>e("svg",{class:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14"},[e("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})],-1)),ns=c(()=>e("span",{class:"sr-only"},"Close modal",-1)),ls=[as,ns],rs={class:"grid gap-4 mb-4 grid-cols-2"},is={class:"col-span-2"},ds={key:0,class:"text-sm font-bold text-red-600 flex"},cs=c(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",x:"20px",y:"0px",width:"25",height:"25",viewBox:"0 0 48 48",class:"pb-1"},[e("path",{fill:"#f44336",d:"M44,24c0,11.045-8.955,20-20,20S4,35.045,4,24S12.955,4,24,4S44,12.955,44,24z"}),e("path",{fill:"#fff",d:"M29.656,15.516l2.828,2.828l-14.14,14.14l-2.828-2.828L29.656,15.516z"}),e("path",{fill:"#fff",d:"M32.484,29.656l-2.828,2.828l-14.14-14.14l2.828-2.828L32.484,29.656z"})],-1)),us={key:1,class:"text-sm font-bold text-blue-600 flex"},ms=c(()=>e("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})],-1)),vs=c(()=>e("label",{for:"name",class:"block mb-2 text-sm font-medwium text-gray-900"},[g("Name "),e("span",{class:"text-red-500"},"*")],-1)),xs=c(()=>e("label",{for:"sensor",class:"block mb-2 text-sm font-medium text-gray-900 p-1"},"Sensor",-1)),hs={class:"col-span-2 flex items-center justify-between"},fs={class:"col-span-2 flex items-center justify-between pt-2"},ps=c(()=>e("label",{for:"executor",class:"block mb-2 text-sm font-medium text-gray-900 p-1"},"Ejecutor",-1)),bs={class:"col-span-2 flex items-center"},gs={class:"col-span-2 flex items-center justify-between pt-2"},ws=c(()=>e("button",{type:"submit",class:"text-white inline-flex items-center bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center"},[e("svg",{class:"me-1 -ms-1 w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"fill-rule":"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z","clip-rule":"evenodd"})]),g(" Crear nuevo espacio ")],-1)),_s={__name:"dashboardView",setup(m){const f=S(ie.currentUser.uid),u=de(),l=S(!1),n=O([]),y=O([]),k=O([]),j=S([]),p=S(""),r=S({name:"",unit:"",value:""}),b=S({name:"",executor:"",state:""}),a=S({id:-1,sensor:!1,executor:!1,addSpace:!1,message:"",editSpace:!1,loading:{load:!1,message:"Cargando..."}}),T=()=>{a.value.id=-1,p.value="",r.value={name:"",unit:"",value:""},b.value={name:"",executor:"",state:0}},C=()=>{a.value={id:-1,sensor:!1,executor:!1,addSpace:!1,message:"",loading:{load:!1,message:"Cargando..."}},T()},z=s=>{s!=null&&Object.keys(s).forEach(o=>{o!=="id"&&(s[o]="")}),C()},M=(s,o=-1)=>{a.value.id=o,a.value[s]=!a.value[s]},J=async()=>{try{if(!p.value.trim())throw new Error("El nombre del espacio no puede estar vacío");if(v.isExistSpace(n,p.value))throw new Error(`Ya existe un espacio con el nombre : ${p.value}`);const s=[{id:V(),...r.value}],o=[{id:V(),...b.value}];if(B(r.value)||B(b.value))throw new Error("Debes añadir al menos un sensor y un ejecutor");a.value.message="",a.value.loading={load:!0,message:"Añadiendo espacio..."},await new Promise(t=>setTimeout(t,300)),n.push({id:V(),name:p.value,sensores:s,ejecutores:o}),await v.updateDocument(f.value,{space:n}),C(),T()}catch(s){a.value.message=s.message}},K=async s=>{try{const o=a.value.sensor?{id:V(),name:s.name,unit:s.unit,value:s.value}:{id:V(),name:s.name,executor:s.executor,state:s.state};if(a.value.id===-1)throw new Error("Debes seleccionar un espacio");if(B(o))throw new Error("Debes completar todos los campos");const t=v.findSpaceIndex(n,a.value.id);if(a.value.sensor&&v.isExistSensor(n,a.value.id,o.name))throw new Error(`Ya existe un sensor con el nombre : ${o.name}`);if(a.value.executor&&v.isExistExecutor(n,a.value.id,o.name))throw new Error(`Ya existe un ejecutor con el nombre : ${o.name}`);a.value.sensor&&(n[t].sensores.push({...o}),a.value.loading={load:!0,message:"Añadiendo sensor..."}),a.value.executor&&(n[t].ejecutores.push({...o}),a.value.loading={load:!0,message:"Añadiendo ejecutor..."}),await new Promise(_=>setTimeout(_,300)),await v.updateDocument(f.value,{space:n}),z(s)}catch(o){a.value.message=o.message}},Q=(s,o)=>{const t=v.findSensor(n,s,o);r.value={...t.data},M("editSpace")},W=(s,o)=>{const t=v.findExecutor(n,s,o);b.value={...t.data},M("editSpace")},X=async s=>{try{const o=v.findSpaceIndex(n,s);confirm(`¿Estás seguro de eliminar el espacio ${n[o].name}?`)&&(n.splice(o,1),await v.updateDocument(f.value,{space:n}),C())}catch(o){console.error(o)}},Z=async(s,o)=>{try{const t=v.findSensor(n,s,o);confirm(`¿Estás seguro de eliminar el sensor ${t.data.name} del espacio ${n[t.indexSpace].name}?`)&&(n[t.indexSpace].sensores.splice(t.executorIndex,1),await v.updateDocument(f.value,{space:n}),C())}catch(t){console.error(t)}},ee=async(s,o)=>{try{const t=v.findExecutor(n,s,o);confirm(`¿Estás seguro de eliminar el ejecutor ${t.data.name} del espacio ${n[t.indexSpace].name}?`)&&(n[t.indexSpace].ejecutores.splice(t.executorIndex,1),await v.updateDocument(f.value,{space:n}),C())}catch(t){console.error(t)}},te=async s=>{try{if(B(s))throw new Error("Debes completar todos los campos");const{indexSpace:o,executorIndex:t}=v.findExecutor(n,a.value.id,s.id);if(s.name!==n[o].ejecutores[t].name&&v.isExistExecutor(n,a.value.id,s.name))throw new Error(`Ya existe un ejecutor con el nombre : ${s.name}`);a.value.loading.load={load:!0,message:"Actualizando ejecutor..."},await new Promise(_=>setTimeout(_,200)),n[o].ejecutores[t]={...s},await v.updateDocument(f.value,{space:n}),C()}catch(o){a.value.message=o.message}},se=async s=>{try{if(B(s))throw new Error("Debes completar todos los campos");const{indexSpace:o,sensorIndex:t}=v.findSensor(n,a.value.id,s.id);if(s.name!==n[o].sensores[t].name&&v.isExistSensor(n,a.value.id,s.name))throw new Error(`Ya existe un sensor con el nombre : ${s.name}`);a.value.loading={load:!0,message:"Actualizando sensor..."},await new Promise(_=>setTimeout(_,200)),n[o].sensores[t]={...s},await v.updateDocument(f.value,{space:n}),C()}catch(o){a.value.message=o.message}},oe=s=>{r.value.name.trim()?se(s):te(s)},L=s=>{const o=s.target.selectedOptions[0].value;s.target.id==="unit"&&(r.value.unit=o),s.target.id==="executor"&&(b.value.executor=o),s.target.id==="stateExecutor"&&(b.value.state=o)},ae=async()=>{try{confirm("¿Estás seguro de cerrar sesión?")&&(await me.logout(),u.replace({name:"home"}))}catch(s){console.log(s)}};return ce(v.name,f.value,s=>{n.splice(0,n.length),s.data().space.map(o=>n.push(o))}),ue(async()=>{l.value=!0;try{const s=async()=>{(await P.getUnits()).map(_=>y.push(_))},o=async()=>{(await P.getExecutors()).forEach(_=>k.push(_))};await s(),await o()}catch(s){console.error(s)}finally{l.value=!1}}),(s,o)=>(i(),d(N,null,[e("nav",Ue,[e("div",Oe,[Te,e("div",He,[e("div",null,[e("button",{class:"flex items-center px-6 py-2 text-white transition duration-500 ease-out bg-blue-700 rounded-lg hover:bg-blue-800 hover:ease-in hover:underline",type:"button",onClick:o[0]||(o[0]=t=>M("addSpace"))},[Fe,g(" Añadir un nuevo espacio ")])]),e("button",{class:"flex items-center px-6 py-2 mx-2 text-black transition duration-700 ease-out bg-white border border-black rounded-lg hover:bg-black hover:border hover:text-white",type:"button",onClick:ae},[Pe,g(" Cerrar sesión ")])])])]),e("main",Ye,[E(he,{class:"fixed top-6 right-4 p-2 bg-gray-200 rounded-full mt-20"}),l.value?(i(),d("div",Re,Je)):w("",!0),n.length===0&&!l.value?(i(),d("div",Ke,[e("div",Qe,[We,e("button",{class:"flex items-center px-6 py-2 mt-4 text-white transition duration-500 ease-out bg-blue-700 rounded-lg hover:bg-blue-800 hover:ease-in hover:underline",type:"button",onClick:o[1]||(o[1]=t=>M("addSpace"))},[Xe,g(" Añadir un nuevo espacio ")])])])):!l.value&&n.length!==0?(i(),d("div",Ze,[e("div",et,[tt,e("div",st,[(i(!0),d(N,null,I(n,(t,_)=>(i(),d("div",{key:t.name,class:"mx-1"},[e("div",ot,[e("div",null,[e("p",at,x(t.name.trim().toLowerCase()),1),e("div",nt,[e("p",lt,"Sensores: "+x(t.sensores.length),1),e("p",rt,"Ejecutores: "+x(t.ejecutores.length),1)])]),e("div",{class:"flex flex-col items-end w-1/2 ml-auto p-5",onClick:h=>j.value[t.name]=!j.value[t.name]},ct,8,it)]),j.value[t.name]?(i(),d("div",ut,[t.sensores.length!==0?(i(),d("div",mt,[vt,(i(!0),d(N,null,I(t.sensores,(h,q)=>(i(),d("div",{key:h.id,class:"w-full flex flex-row bg-blue-600 rounder-lg pl-8"},[e("div",xt,[e("p",ht,x(q+1)+" - "+x(h.name),1)]),e("div",ft,[e("p",pt,x(h.unit),1)]),e("div",bt,[e("p",gt,x(h.value),1)]),e("div",wt,[e("div",_t,[e("button",{class:"flex items-center px-6 py-2 mx-2 text-white transition duration-500 ease-out bg-blue-700 rounded-lg hover:bg-blue-800 hover:ease-in hover:underline",type:"button",onClick:U=>{Q(t.id,h.id),a.value.id=t.id}},St,8,yt),e("button",{class:"flex items-center px-3 py-2 mx-2 text-white transition duration-500 ease-out bg-red-700 rounded-lg hover:bg-red-800 hover:ease-in hover:underline",type:"button",onClick:U=>Z(t.id,h.id)},Et,8,jt)])])]))),128))])):w("",!0),t.ejecutores.length!==0?(i(),d("div",$t,[e("div",null,[Mt,(i(!0),d(N,null,I(t.ejecutores,(h,q)=>(i(),d("div",{key:h.id,class:"w-full flex flex-row bg-blue-600 rounder-lg pl-8 pb-2"},[e("div",Dt,[e("p",Vt,x(q+1)+" - "+x(h.name),1)]),e("div",Bt,[e("p",Nt,x(h.executor),1)]),e("div",At,[e("p",It,x(h.state),1)]),e("div",zt,[e("div",Lt,[e("button",{class:"flex items-center px-6 py-2 mx-2 text-white transition duration-500 ease-out bg-blue-700 rounded-lg hover:bg-blue-800 hover:ease-in hover:underline",type:"button",onClick:U=>{W(t.id,h.id),a.value.id=t.id}},Ot,8,qt),e("button",{class:"flex items-center px-3 py-2 mx-2 text-white transition duration-500 ease-out bg-red-700 rounded-lg hover:bg-red-800 hover:ease-in hover:underline",type:"button",onClick:U=>ee(t.id,h.id)},Ft,8,Tt)])])]))),128))])])):w("",!0),t.sensores.length===0&&t.ejecutores.length===0?(i(),d("div",Pt,Rt)):w("",!0),e("div",null,[e("div",Gt,[e("button",{class:"flex items-center px-4 py-2 mx-2 text-white transition duration-500 ease-out bg-blue-700 rounded-lg hover:bg-blue-800 hover:ease-in hover:underline",type:"button",onClick:h=>M("sensor",t.id),id:_},[Kt,g(" Añadir un nuevo sensor ")],8,Jt),e("button",{class:"flex items-center px-4 py-2 mx-2 text-white transition duration-500 ease-out bg-blue-700 rounded-lg hover:bg-blue-800 hover:ease-in hover:underline",type:"button",onClick:h=>M("executor",t.id)},[Wt,g(" Añadir un nuevo ejecutor ")],8,Qt),e("button",{class:"flex items-center px-4 py-2 mx-2 text-white transition duration-500 ease-out bg-red-700 rounded-lg hover:bg-red-800 hover:ease-in hover:underline",type:"button",onClick:h=>X(t.id)},[Zt,g(" Eliminar espacio ")],8,Xt)])])])):w("",!0)]))),128))])])])):w("",!0),E(H,{head:`Añadir un nuevo ${a.value.sensor?"sensor":"ejecutor"}`,name:a.value.sensor?"sensor":"executor",placeholder:a.value.sensor?"Nombre del sensor":"Nombre del ejecutor",elements:a.value.sensor?y:k,state:a.value.executor?[{name:"Activo",value:1},{name:"Inactivo",value:0}]:[],value:a.value[a.value.sensor?"sensor":"executor"],onCloseModal:z,onHandleSubmit:K,messageError:a.value.message,isLoading:a.value.loading,initialData:a.value.sensor?r.value:b.value},null,8,["head","name","placeholder","elements","state","value","messageError","isLoading","initialData"]),E(H,{head:`Modificar ${r.value.name.trim()?"sensor":"ejecutor"} ${r.value.name}`,name:r.value.name.trim()?"sensor":"ejecutor",placeholder:`Nombre del ${r.value.name.trim()?"sensor":"ejecutor"}`,elements:r.value.name.trim()?y:k,state:r.value.name.trim()?[]:[{name:"Activo",value:1},{name:"Inactivo",value:0}],value:a.value.editSpace,onCloseModal:z,onHandleSubmit:oe,messageError:a.value.message,isLoading:a.value.loading,initialData:r.value.name.trim()?r.value:b.value},null,8,["head","name","placeholder","elements","state","value","messageError","isLoading","initialData"]),a.value.addSpace?(i(),d("div",es,[e("div",ts,[e("div",ss,[e("div",{class:"flex items-center justify-between p-4 md:p-5 border-b rounded-t"},[os,e("button",{type:"button",class:"text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center","data-modal-toggle":"crud-modal",onClick:C},ls)]),e("form",{class:"p-4 md:p-5",onSubmit:R(J,["prevent"])},[e("div",rs,[e("div",is,[a.value.message!==""?(i(),d("p",ds,[cs,g(" "+x(a.value.message),1)])):w("",!0),a.value.loading.load?(i(),d("p",us,[ms,g(" "+x(a.value.loading.message),1)])):w("",!0),vs,$(e("input",{type:"text",name:"name",id:"name",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5",placeholder:"Nombre del espacio","onUpdate:modelValue":o[2]||(o[2]=t=>p.value=t)},null,512),[[D,p.value]]),xs,e("div",hs,[$(e("input",{type:"text",name:"sensor",id:"sensor",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 mr-2",placeholder:"Nombre del sensor","onUpdate:modelValue":o[3]||(o[3]=t=>r.value.name=t)},null,512),[[D,r.value.name]]),E(A,{name:"unit",elementos:y,onChange:L},null,8,["elementos"])]),e("div",fs,[$(e("input",{type:"text",name:"value",id:"value",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5",placeholder:"Valor de la unidad","onUpdate:modelValue":o[4]||(o[4]=t=>r.value.value=t)},null,512),[[D,r.value.value]])]),ps,e("div",bs,[$(e("input",{type:"text",name:"executor",id:"executor",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 mr-2",placeholder:"Nombre del ejecutor","onUpdate:modelValue":o[5]||(o[5]=t=>b.value.name=t)},null,512),[[D,b.value.name]]),E(A,{name:"executor",elementos:k,onChange:L},null,8,["elementos"])]),e("div",gs,[E(A,{name:"stateExecutor",id:"stateExecutor",elementos:[{name:"Activo",value:1},{name:"Inactivo",value:0}],text:"Estado del ejecutor",onChange:L})])])]),ws],32)])])])):w("",!0)])],64))}},Ms=fe(_s,[["__scopeId","data-v-fbc76d74"]]);export{Ms as default};
