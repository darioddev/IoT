import{r as S,l as Q,m as D,v as ne,b as r,c as d,t as f,g,F as I,j as H,d as e,k as T,f as x,p as B,e as N,q as ie,s as re,x as de,y as ce,z as ue,A as me,u as he,i as U,B as G,C as ve,n as W,h as pe,D as xe,E as fe,G as ge,H as L}from"./index-R0ar4AwP.js";import{_ as be}from"./buttonThemeComponet-ZFw02k1L.js";import{h as q}from"./validations-CYGvCaOF.js";import{_ as _e}from"./_plugin-vue_export-helper-x3n3nnut.js";import"https://www.gstatic.com/firebasejs/9.6.2/firebase-app.js";import"https://www.gstatic.com/firebasejs/9.6.2/firebase-firestore.js";import"https://www.gstatic.com/firebasejs/9.6.2/firebase-auth.js";const we=["name","id"],ye={key:0,value:"",disabled:"",selected:""},ke=["value"],A={__name:"selectComponent",props:{name:{type:String,required:!0},elementos:{type:Array,required:!0},text:{type:String,required:!1,default:"Selecciona una opción"},selectedValue:{type:[String,Number,Boolean],required:!1,default:""}},setup(c){const{name:n,elementos:m,text:u,selectedValue:h}=c,b=S(h);return Q(()=>h,j=>{b.value=j},{immediate:!0,deep:!0}),(j,$)=>D((r(),d("select",{name:c.name,id:c.name,class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5","onUpdate:modelValue":$[0]||($[0]=w=>b.value=w)},[c.selectedValue?g("",!0):(r(),d("option",ye,f(c.text),1)),(r(!0),d(I,null,H(c.elementos,w=>(r(),d("option",{key:w.name,value:w.value??w.name},f(w.name),9,ke))),128))],8,we)),[[ne,b.value]])}},Ce={key:0,id:"crud-modal",tabindex:"-1","aria-hidden":"true",class:"flex overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full"},Se={class:"relative p-4 w-full max-w-md max-h-full"},je={class:"relative bg-white rounded-lg shadow",id:"modal"},$e={class:"flex items-center justify-between p-4 md:p-5 border-b rounded-t"},Ee={class:"text-lg font-semibold text-gray-900"},Me=e("svg",{class:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14"},[e("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})],-1),De=e("span",{class:"sr-only"},"Close modal",-1),Ve=[Me,De],Ne={class:"mb-4"},Be={class:"mb-2"},ze={key:0,class:"text-sm font-bold text-red-600 text-center flex items-center justify-center"},Le=e("svg",{xmlns:"http://www.w3.org/2000/svg",x:"20px",y:"0px",width:"25",height:"25",viewBox:"0 0 48 48",class:""},[e("path",{fill:"#f44336",d:"M44,24c0,11.045-8.955,20-20,20S4,35.045,4,24S12.955,4,24,4S44,12.955,44,24z"}),e("path",{fill:"#fff",d:"M29.656,15.516l2.828,2.828l-14.14,14.14l-2.828-2.828L29.656,15.516z"}),e("path",{fill:"#fff",d:"M32.484,29.656l-2.828,2.828l-14.14-14.14l2.828-2.828L32.484,29.656z"})],-1),Ae={key:1,class:"text-sm font-bold text-blue-600 text-center flex items-center justify-center"},Ue=e("svg",{class:"animate-spin -ms-1 w-5 h-5 me-3",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})],-1),qe={class:"col-span-2 flex items-center justify-between"},Ie=["name","id","placeholder"],Oe={class:"col-span-2 flex items-center justify-between pt-2"},He={type:"submit",class:"text-white inline-flex items-center bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center"},Te=e("svg",{class:"me-1 -ms-1 w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"fill-rule":"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z","clip-rule":"evenodd"})],-1),J={__name:"modalComponent",props:{head:{type:String,required:!0},name:{type:String,required:!0},placeholder:{type:String,required:!1,default:""},elements:{type:Array,required:!0},state:{type:Array,required:!1,default:()=>[]},value:{type:Boolean,required:!1,default:!1},messageError:{type:String,required:!1,default:""},initialData:{type:Object,required:!1,default:()=>({})},isLoading:{type:Object,required:!1}},emits:["closeModal","handleSubmit"],setup(c,{emit:n}){const m=c,u=S({name:"",unit:"",value:"",executor:"",state:1}),h=n,b=()=>h("handleSubmit",u.value),j=()=>h("closeModal",u.value),$=_=>{m.state.length===0?u.value={...u.value,unit:_.target.value}:u.value={...u.value,executor:_.target.value},console.log("he seleccionado",_.target.value)},w=_=>{u.value={...u.value,state:_.target.value}};return Q(()=>m.initialData,_=>{u.value={..._}},{deep:!0}),(_,v)=>m.value?(r(),d("div",Ce,[e("div",Se,[e("div",je,[e("div",$e,[e("h3",Ee,f(m.head),1),e("button",{type:"button",class:"text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center","data-modal-toggle":"crud-modal",onClick:j},Ve)]),e("form",{class:"p-4 md:p-5",onSubmit:T(b,["prevent"])},[e("div",Ne,[e("div",Be,[m.messageError!==""?(r(),d("p",ze,[Le,x(" "+f(m.messageError),1)])):g("",!0),m.isLoading.load?(r(),d("p",Ae,[Ue,x(" "+f(m.isLoading.message),1)])):g("",!0)]),e("div",qe,[D(e("input",{type:"text",name:m.name,id:m.name,class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 mr-2",placeholder:c.placeholder,"onUpdate:modelValue":v[0]||(v[0]=y=>u.value.name=y)},null,8,Ie),[[B,u.value.name]]),N(A,{name:m.name,elementos:m.elements,onChange:$,selectedValue:u.value.unit||u.value.executor},null,8,["name","elementos","selectedValue"])]),e("div",Oe,[m.state.length===0?D((r(),d("input",{key:0,type:"text",name:"value",id:"value",class:"bg-gray-50 border border-gray-300 teaxt-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5",placeholder:"Valor de la unidad","onUpdate:modelValue":v[1]||(v[1]=y=>u.value.value=y)},null,512)),[[B,u.value.value]]):(r(),ie(A,{key:1,name:m.name,elementos:m.state,onChange:w,selectedValue:u.value.state,text:"Estado del ejecutor"},null,8,["name","elementos","selectedValue"]))])]),e("button",He,[Te,x(" "+f(c.head),1)])],32)])])])):g("",!0)}},K=c=>new Promise(n=>{ue(c,m=>{n(m.docs.map(u=>({id:u.id,...u.data()})))})}),k={name:"devices",space:"spaces",unitName:"units",executorName:"executores",async getUnits(){return await K(this.unitName)},async getExecutors(){return await K(this.executorName)},async saveDevice(c,n){try{return await re(this.space,c,this.name,n)}catch(m){throw new Error(m)}},isExistDevice(c,n,m){return c.filter(h=>h.type===n).some(h=>h.name.trim().toUpperCase()===m.trim().toUpperCase())},async updateDevice(c,n,m){await de(this.space,c,this.name,n,m)},async deleteDevice(c,n){await ce(this.space,c,this.name,n)},deviceObject(c,n){return c?{name:n.name,unit:n.unit,value:n.value,type:"sensor"}:{name:n.name,executor:n.executor,state:n.state,type:"executor"}}},a=c=>(fe("data-v-6040594d"),c=c(),ge(),c),Fe={class:"fixed inset-x-0 top-0 z-10 w-full px-4 py-1 bg-white shadow-md border-slate-500 transition duration-700 ease-out"},Pe={class:"flex justify-between p-4"},Ye=a(()=>e("div",{class:"text-[2rem] leading-[3rem] tracking-tight font-bold text-black",id:"h1"},[x(" Bienvenido a "),e("span",{class:"text-blue-700"},"IoT")],-1)),Re={class:"flex items-center space-x-4 text-lg font-semibold tracking-tight"},Ge=a(()=>e("svg",{class:"w-6 h-6 text-black mx-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"{2}",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1)),We=a(()=>e("svg",{class:"w-6 h-6 text-black mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"{2}",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1)),Je={class:"flex flex-col items-center justify-center w-full h-screen bg-gray-100"},Ke={key:0,class:"absolute top-0 left-0 w-full h-full flex items-center justify-center bg-white opacity-75"},Qe=a(()=>e("p",{class:"text-2xl font-bold text-gray-500"},"Cargando...",-1)),Xe=[Qe],Ze={key:1},et={class:"flex flex-col items-center justify-center w-full h-full"},tt=a(()=>e("p",{class:"text-2xl font-bold text-gray-500"},"No tienes ningún espacio",-1)),st=a(()=>e("svg",{class:"w-6 h-6 text-black mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"{2}",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1)),ot={key:2,class:"flex flex-col items-start justify-start h-screen pt-20 w-full"},lt={class:"w-full"},at=a(()=>e("div",{class:"p-4"},[e("p",{class:"text-3xl font-bold text-gray-500"},"Tus espacios")],-1)),nt={class:"flex flex-col justify-center w-ful mx-4"},it={class:"w-full flex rounded-t-lg bg-blue-700 mt-1"},rt={class:"text-2xl font-bold text-white p-2"},dt={class:"flex items-center p-1 containerDevice"},ct={class:"text-base font-bold text-white mx-1"},ut=["onClick"],mt=a(()=>e("svg",{class:"w-6 h-6 text-white mr-2 mt-2 rounded-lg cursor-pointer hover:bg-sky-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",title:"Más información sobre el espacio"},[x(" > > "),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"{2}",d:"M19 5l-7 7-7-7"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"{2}",d:"M19 5l-7 7-7-7"})],-1)),ht=[mt],vt={key:0},pt={key:0},xt={key:0,class:"w-full"},ft={class:"w-full flex flex-row bg-blue-600 rounder-lg p-2 items-center"},gt={class:"w-1/3 mx-4"},bt={class:"text-base font-medium text-white flex items-center"},_t=a(()=>e("i",{class:"bx bx-radar bx-sm",style:{"vertical-align":"middle"}},null,-1)),wt={class:"font-bold px-2 cursor-pointer",title:"Nombre del sensor"},yt={class:"w-1/3 pl-2"},kt={class:"text-base font-medium text-white flex items-center"},Ct=a(()=>e("i",{class:"bx bxs-bolt-circle bx-sm cursor-pointer",style:{"vertical-align":"middle"},title:"Unidad del sensor"},null,-1)),St={class:"font-bold px-2 cursor-pointer",title:"Unidad del sensor "},jt={class:"w-1/3 pl-2"},$t={class:"text-base font-medium text-white flex items-center"},Et=a(()=>e("i",{class:"bx bxs-data bx-sm cursor-pointer",style:{"vertical-align":"middle"},title:"Valor del sensor"},null,-1)),Mt={class:"font-bold px-2 cursor-pointer",title:"Valor del sensor"},Dt={class:"w-1/3"},Vt={class:"flex flex-row item-center justify-end mr-20"},Nt=["onClick"],Bt=a(()=>e("i",{class:"bx bxs-rename"},null,-1)),zt=[Bt],Lt=["onClick"],At=a(()=>e("i",{class:"bx bxs-trash"},null,-1)),Ut=[At],qt={key:1},It={class:"w-full flex flex-row bg-blue-600 rounder-lg p-2 items-center"},Ot={class:"w-1/3 mx-4"},Ht={class:"text-base font-medium text-white flex items-center"},Tt=a(()=>e("i",{class:"bx bx-devices bx-sm",style:{"vertical-align":"middle"},title:"Nombre del ejecutor"},null,-1)),Ft={class:"font-bold px-2 cursor-pointer",title:"Nombre del ejecutor"},Pt={class:"w-1/3 pl-2"},Yt={class:"text-base font-medium text-white flex items-center"},Rt=a(()=>e("i",{class:"bx bxs-data bx-sm cursor-pointer",style:{"vertical-align":"middle"},title:"Dispositivo del ejecutor"},null,-1)),Gt={class:"font-bold px-2 cursor-pointer",title:"Dispositivo del ejecutor"},Wt={class:"w-1/3 pl-2"},Jt={class:"text-base font-medium text-white flex items-center"},Kt=["onClick"],Qt={class:"w-1/3"},Xt={class:"flex flex-row item-center justify-end mr-20"},Zt=["onClick"],es=a(()=>e("i",{class:"bx bxs-rename"},null,-1)),ts=[es],ss=["onClick"],os=a(()=>e("i",{class:"bx bxs-trash"},null,-1)),ls=[os],as={key:1},ns=a(()=>e("div",{class:"flex flex-col items-center justify-center w-full p-2 bg-blue-100 content"},[e("p",{class:"text-2xl font-bold text-gray-500"},"No tienes sensores ni ejecutores en este espacio")],-1)),is=[ns],rs={class:"flex flex-row bg-blue-700 rounded-b-lg p-3"},ds=["onClick","id"],cs=a(()=>e("i",{class:"bx bx-radar bx-sm"},null,-1)),us=a(()=>e("span",{class:"hidden md:block"},"Añadir un nuevo sensor",-1)),ms=[cs,us],hs=["onClick"],vs=a(()=>e("i",{class:"bx bx-devices bx-sm"},null,-1)),ps=a(()=>e("span",{class:"hidden md:block"},"Añadir un nuevo ejecutor",-1)),xs=[vs,ps],fs=["onClick"],gs=a(()=>e("i",{class:"bx bxs-rename"},null,-1)),bs=a(()=>e("span",{class:"hidden md:block"},"Renombrar",-1)),_s=[gs,bs],ws=["onClick"],ys=a(()=>e("i",{class:"bx bxs-trash text-lg mr-1"},null,-1)),ks=a(()=>e("span",{class:"hidden md:block"},"Eliminar espacio",-1)),Cs=[ys,ks],Ss={key:3,id:"crud-modal",tabindex:"-1","aria-hidden":"true",class:"flex overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full"},js={class:"relative p-4 w-full max-w-md max-h-full"},$s={class:"relative bg-white rounded-lg shadow",id:"modal"},Es=a(()=>e("h3",{class:"text-lg font-semibold text-gray-900"}," Modificar nombre ",-1)),Ms=a(()=>e("svg",{class:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14"},[e("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})],-1)),Ds=a(()=>e("span",{class:"sr-only"},"Close modal",-1)),Vs=[Ms,Ds],Ns={class:"grid gap-4 mb-4 grid-cols-2"},Bs={class:"col-span-2"},zs={key:0,class:"text-sm font-bold text-red-600 flex"},Ls=a(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",x:"20px",y:"0px",width:"25",height:"25",viewBox:"0 0 48 48",class:"pb-1"},[e("path",{fill:"#f44336",d:"M44,24c0,11.045-8.955,20-20,20S4,35.045,4,24S12.955,4,24,4S44,12.955,44,24z"}),e("path",{fill:"#fff",d:"M29.656,15.516l2.828,2.828l-14.14,14.14l-2.828-2.828L29.656,15.516z"}),e("path",{fill:"#fff",d:"M32.484,29.656l-2.828,2.828l-14.14-14.14l2.828-2.828L32.484,29.656z"})],-1)),As={key:1,class:"text-sm font-bold text-blue-600 flex text-center"},Us=a(()=>e("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})],-1)),qs=a(()=>e("label",{for:"name",class:"block mb-2 text-sm font-medwium text-gray-900"},[x("Name "),e("span",{class:"text-red-500"},"*")],-1)),Is=a(()=>e("button",{type:"submit",class:"text-white inline-flex items-center bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center"},[e("svg",{class:"me-1 -ms-1 w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"fill-rule":"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z","clip-rule":"evenodd"})]),x(" Renombrar espacio ")],-1)),Os={key:4,id:"crud-modal",tabindex:"-1","aria-hidden":"true",class:"flex overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full"},Hs={class:"relative p-4 w-full max-w-md max-h-full"},Ts={class:"relative bg-white rounded-lg shadow",id:"modal"},Fs=a(()=>e("h3",{class:"text-lg font-semibold text-gray-900"}," Crear un nuevo espacio ",-1)),Ps=a(()=>e("svg",{class:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14"},[e("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})],-1)),Ys=a(()=>e("span",{class:"sr-only"},"Close modal",-1)),Rs=[Ps,Ys],Gs={class:"grid gap-4 mb-4 grid-cols-2"},Ws={class:"col-span-2"},Js={key:0,class:"text-sm font-bold text-red-600 flex"},Ks=a(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",x:"20px",y:"0px",width:"25",height:"25",viewBox:"0 0 48 48",class:"pb-1"},[e("path",{fill:"#f44336",d:"M44,24c0,11.045-8.955,20-20,20S4,35.045,4,24S12.955,4,24,4S44,12.955,44,24z"}),e("path",{fill:"#fff",d:"M29.656,15.516l2.828,2.828l-14.14,14.14l-2.828-2.828L29.656,15.516z"}),e("path",{fill:"#fff",d:"M32.484,29.656l-2.828,2.828l-14.14-14.14l2.828-2.828L32.484,29.656z"})],-1)),Qs={key:1,class:"text-sm font-bold text-blue-600 flex text-center"},Xs=a(()=>e("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})],-1)),Zs=a(()=>e("label",{for:"name",class:"block mb-2 text-sm font-medwium text-gray-900"},[x("Name "),e("span",{class:"text-red-500"},"*")],-1)),eo={key:2},to=a(()=>e("label",{for:"sensor",class:"block mb-2 text-sm font-medium text-gray-900 p-1"},[x("Sensor "),e("span",{class:"text-red-500"},"*")],-1)),so={class:"col-span-2 flex items-center justify-between"},oo={class:"col-span-2 flex items-center justify-between pt-2"},lo=a(()=>e("label",{for:"executor",class:"block mb-2 text-sm font-medium text-gray-900 p-1"},[x("Ejecutor "),e("span",{class:"text-red-500"},"*")],-1)),ao={class:"col-span-2 flex items-center"},no={class:"col-span-2 flex items-center justify-between pt-2"},io={class:"flex items-center justify-start"},ro={for:"toggle",class:"flex items-center cursor-pointer"},co=a(()=>e("div",{class:"text-gray-900 text-center"}," Crear espacio sin dispositivos ",-1)),uo=a(()=>e("button",{type:"submit",class:"text-white inline-flex items-center bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center"},[e("svg",{class:"me-1 -ms-1 w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"fill-rule":"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z","clip-rule":"evenodd"})]),x(" Crear nuevo espacio ")],-1)),mo={__name:"dashboardView",setup(c){const n=S(me.currentUser.uid),m=he(),u=S(!1),h=U([]),b=U([]),j=U([]),$=U([]),w=S([]),_=t=>b.filter(s=>s.idSpace===t),v=S(""),y=S(!1),p=S({name:"",unit:"",type:"sensor",value:""}),C=S({name:"",executor:"",type:"executor",state:1}),l=S({id:-1,sensor:!1,executor:!1,addSpace:!1,name:!1,message:"",editSpace:!1,loading:{load:!1,message:"Cargando..."}}),X=()=>{l.value.id=-1,v.value="",p.value={name:"",unit:"",value:""},C.value={name:"",executor:"",state:1},y.value=!1},V=()=>{l.value={id:-1,sensor:!1,executor:!1,addSpace:!1,name:!1,message:"",loading:{load:!1,message:"Cargando..."}},X()},F=t=>{t!=null&&Object.keys(t).forEach(s=>{s!=="id"&&(t[s]="")}),V()},z=(t,s=-1)=>{l.value.id=s,l.value[t]=!l.value[t]},Z=async()=>{try{if(!v.value.trim())throw new Error("El nombre del espacio no puede estar vacío");if(L.isExistSpace(h,v.value))throw new Error(`Ya existe un espacio con el nombre : ${v.value}`);if(!y.value){if(q(p.value))throw new Error("Los campos del sensor no pueden estar vacíos");if(q(C.value))throw new Error("Los campos del ejecutor no pueden estar vacíos")}l.value.loading={load:!0,message:"Creando espacio..."},await new Promise(s=>setTimeout(s,500));const t=await L.saveSpace(n.value,{name:v.value});y.value||(await k.saveDevice(n.value,{...p.value,idSpace:t.id}),await k.saveDevice(n.value,{...C.value,idSpace:t.id})),V()}catch(t){l.value.message=t.message}},ee=async t=>{try{if(t=k.deviceObject(l.value.sensor,t),q(t))throw new Error("Debes completar todos los campos");const s=_(l.value.id);if(l.value.sensor){if(k.isExistDevice(s,"sensor",t.name))throw new Error(`Ya existe un sensor con el nombre : ${t.name} en el espacio ${h.find(o=>o.id===l.value.id).name}`)}else if(k.isExistDevice(s,"executor",t.name))throw new Error(`Ya existe un ejecutor con el nombre : ${t.name}`);l.value.loading={load:!0,message:`Añadiendo ${t.type}...`},await new Promise(o=>setTimeout(o,500)),await k.saveDevice(n.value,{...t,idSpace:l.value.id}),V()}catch(s){l.value.message=s.message}},te=async t=>{try{confirm(`¿Estás seguro de eliminar el espacio ${h.find(s=>s.id===t).name}?`)&&await L.deleteDocument(n.value,t)}catch(s){console.error(s)}},P=async(t,s)=>{try{const o=h.find(M=>M.id===t).name,{name:i,type:E}=b.find(M=>M.id===s);confirm(`¿Estás seguro de eliminar el ${E} ${i} del espacio ${o}?`)&&await k.deleteDevice(n.value,s)}catch(o){console.error(o)}},Y=(t,s)=>{const o=b.find(i=>i.id===t&&i.type===s);s==="sensor"&&(p.value={...o}),s==="executor"&&(C.value={...o}),z("editSpace")},se=t=>{v.value=h.find(s=>s.id===t).name,z("name",t)},R=async(t,s)=>{try{if(q(t))throw new Error("Debes completar todos los campos");const o=b.find(M=>M.id===t.id&&M.type===s);if(t.name!==o.name&&k.isExistDevice(b,s,t.name))throw new Error(`Ya existe un sensor con el nombre : ${t.name}`);const{id:i,...E}=t;l.value.loading={load:!0,message:`Actualizando ${s}...`},await new Promise(M=>setTimeout(M,500)),k.updateDevice(n.value,i,{...E}),V()}catch(o){l.value.message=o.message}},oe=async()=>{try{if(!v.value.trim())throw new Error("El nombre del espacio no puede estar vacío");const t=h.find(s=>s.id===l.value.id);if(L.isExistSpace(h,v.value)&&v.value!==t.name)throw new Error(`Ya existe un espacio con el nombre : ${v.value}`);l.value.loading={load:!0,message:"Actualizando nombre del espacio..."},await new Promise(s=>setTimeout(s,500)),L.updateSpace(n.value,l.value.id,{name:v.value}),V()}catch(t){l.value.message=t.message}},le=t=>{p.value.name.trim()?R(t,"sensor"):R(t,"executor")},O=t=>{const s=t.target.selectedOptions[0].value;t.target.id==="unit"&&(p.value.unit=s),t.target.id==="executor"&&(C.value.executor=s),t.target.id==="stateExecutor"&&(C.value.state=s)},ae=async()=>{try{confirm("¿Estás seguro de cerrar sesión?")&&(await pe.logout(),m.replace({name:"home"}))}catch(t){console.log(t)}};return G("spaces",n.value,"names",t=>{h.splice(0,h.length),t.forEach(s=>h.push({id:s.id,name:s.data().name}))}),G("spaces",n.value,"devices",t=>{b.splice(0,b.length),t.forEach(s=>b.push({id:s.id,...s.data()}))}),ve(async()=>{u.value=!0;try{const t=async()=>{(await k.getUnits()).map(i=>j.push(i))},s=async()=>{(await k.getExecutors()).forEach(i=>$.push(i))};await t(),await s()}catch(t){console.error(t)}finally{u.value=!1}}),(t,s)=>(r(),d(I,null,[e("nav",Fe,[e("div",Pe,[Ye,e("div",Re,[e("div",null,[e("button",{class:"flex items-center px-6 py-2 text-white transition duration-500 ease-out bg-blue-700 rounded-lg hover:bg-blue-800 hover:ease-in hover:underline",type:"button",onClick:s[0]||(s[0]=o=>z("addSpace"))},[Ge,x(" Añadir un nuevo espacio ")])]),e("button",{class:"flex items-center px-6 py-2 mx-2 text-black transition duration-700 ease-out bg-white border border-black rounded-lg hover:bg-black hover:border hover:text-white",type:"button",onClick:ae},[We,x(" Cerrar sesión ")])])])]),e("main",Je,[N(be,{class:"fixed top-6 right-4 p-2 bg-gray-200 rounded-full mt-20"}),u.value?(r(),d("div",Ke,Xe)):g("",!0),h.length===0&&!u.value?(r(),d("div",Ze,[e("div",et,[tt,e("button",{class:"flex items-center px-6 py-2 mt-4 text-white transition duration-500 ease-out bg-blue-700 rounded-lg hover:bg-blue-800 hover:ease-in hover:underline",type:"button",onClick:s[1]||(s[1]=o=>z("addSpace"))},[st,x(" Añadir un nuevo espacio ")])])])):!u.value&&h.length!==0?(r(),d("div",ot,[e("div",lt,[at,e("div",nt,[(r(!0),d(I,null,H(h,o=>(r(),d("div",{key:o.name,class:"mx-1"},[e("div",it,[e("div",null,[e("p",rt,f(o.name.trim().toLowerCase()),1),e("div",dt,[e("p",ct,"Número de dispositivos : "+f(_(o.id).length),1)])]),e("div",{class:"flex flex-col items-end w-1/2 ml-auto p-5",onClick:i=>w.value[o.name]=!w.value[o.name]},ht,8,ut)]),w.value[o.name]?(r(),d("div",vt,[_(o.id).length!==0?(r(),d("div",pt,[(r(!0),d(I,null,H(_(o.id),i=>(r(),d("div",{key:i.id,class:""},[i.type==="sensor"?(r(),d("div",xt,[e("div",ft,[e("div",gt,[e("p",bt,[_t,e("span",wt,f(i.name.toLowerCase()),1)])]),e("div",yt,[e("p",kt,[Ct,e("span",St,f(i.unit),1)])]),e("div",jt,[e("p",$t,[Et,e("span",Mt,f(i.value),1)])]),e("div",Dt,[e("div",Vt,[e("button",{class:"flex items-center px-6 py-2 mx-2 text-white transition duration-500 ease-out bg-blue-700 rounded-lg hover:bg-blue-800 hover:ease-in hover:underline",type:"button",onClick:E=>Y(i.id,"sensor")},zt,8,Nt),e("button",{class:"flex items-center px-3 py-2 mx-2 text-white transition duration-500 ease-out bg-red-700 rounded-lg hover:bg-red-800 hover:ease-in hover:underline",type:"button",onClick:E=>P(o.id,i.id)},Ut,8,Lt)])])])])):(r(),d("div",qt,[e("div",It,[e("div",Ot,[e("p",Ht,[Tt,e("span",Ft,f(i.name),1)])]),e("div",Pt,[e("p",Yt,[Rt,e("span",Gt,f(i.executor),1)])]),e("div",Wt,[e("p",Jt,[e("i",{class:W(["bx",Number(i.state)===1?"bxs-toggle-right":"bxs-toggle-left","bx-lg","cursor-pointer",Number(i.state)===1?"text-green-500":"text-red-500","rounded-full","transition-opacity duration-300 ease-in-out"]),style:{"vertical-align":"middle",opacity:"1"},title:"Estado del ejecutor",onClick:E=>xe(k).updateDevice(n.value,i.id,{state:i.state===1?0:1})},null,10,Kt)])]),e("div",Qt,[e("div",Xt,[e("button",{class:"flex items-center px-6 py-2 mx-2 text-white transition duration-500 ease-out bg-blue-700 rounded-lg hover:bg-blue-800 hover:ease-in hover:underline",type:"button",onClick:E=>Y(i.id,"executor")},ts,8,Zt),e("button",{class:"flex items-center px-3 py-2 mx-2 text-white transition duration-500 ease-out bg-red-700 rounded-lg hover:bg-red-800 hover:ease-in hover:underline",type:"button",onClick:E=>P(o.id,i.id)},ls,8,ss)])])])]))]))),128))])):g("",!0),_(o.id).length===0?(r(),d("div",as,is)):g("",!0),e("div",null,[e("div",rs,[e("button",{class:"flex items-center px-4 py-2 mx-2 text-white transition duration-500 ease-out bg-blue-700 rounded-lg hover:bg-blue-800 hover:ease-in hover:underline",type:"button",onClick:i=>z("sensor",o.id),id:n.value},ms,8,ds),e("button",{class:"flex items-center px-4 py-2 mx-2 text-white transition duration-500 ease-out bg-blue-700 rounded-lg hover:bg-blue-800 hover:ease-in hover:underline",type:"button",onClick:i=>z("executor",o.id)},xs,8,hs),e("button",{class:"flex items-center px-4 py-2 mx-2 text-white transition duration-500 ease-out bg-blue-700 rounded-lg hover:bg-blue-800 hover:ease-in hover:underline",type:"button",onClick:i=>se(o.id)},_s,8,fs),e("button",{class:"flex items-center px-4 py-2 mx-2 text-white transition duration-500 ease-out bg-red-700 rounded-lg hover:bg-red-800 hover:ease-in hover:underline",type:"button",onClick:i=>te(o.id)},Cs,8,ws)])])])):g("",!0)]))),128))])])])):g("",!0),N(J,{head:`Añadir un nuevo ${l.value.sensor?"sensor":"ejecutor"}`,name:l.value.sensor?"sensor":"executor",placeholder:l.value.sensor?"Nombre del sensor":"Nombre del ejecutor",elements:l.value.sensor?j:$,state:l.value.executor?[{name:"Activo",value:1},{name:"Inactivo",value:0}]:[],value:l.value[l.value.sensor?"sensor":"executor"],onCloseModal:F,onHandleSubmit:ee,messageError:l.value.message,isLoading:l.value.loading,initialData:l.value.sensor?p.value:C.value},null,8,["head","name","placeholder","elements","state","value","messageError","isLoading","initialData"]),N(J,{head:`Modificar ${p.value.name.trim()?"sensor":"ejecutor"} ${p.value.name}`,name:p.value.name.trim()?"sensor":"ejecutor",placeholder:`Nombre del ${p.value.name.trim()?"sensor":"ejecutor"}`,elements:p.value.name.trim()?j:$,state:p.value.name.trim()?[]:[{name:"Activo",value:1},{name:"Inactivo",value:0}],value:l.value.editSpace,onCloseModal:F,onHandleSubmit:le,messageError:l.value.message,isLoading:l.value.loading,initialData:p.value.name.trim()?p.value:C.value},null,8,["head","name","placeholder","elements","state","value","messageError","isLoading","initialData"]),l.value.name?(r(),d("div",Ss,[e("div",js,[e("div",$s,[e("div",{class:"flex items center justify-between p-4 md:p-5 border-b rounded-t"},[Es,e("button",{type:"button",class:"text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center","data-modal-toggle":"crud-modal",onClick:V},Vs)]),e("form",{class:"p-4 md:p-5",onSubmit:T(oe,["prevent"])},[e("div",Ns,[e("div",Bs,[l.value.message!==""?(r(),d("p",zs,[Ls,x(" "+f(l.value.message),1)])):g("",!0),l.value.loading.load?(r(),d("p",As,[Us,x(" "+f(l.value.loading.message),1)])):g("",!0),qs,D(e("input",{type:"text",name:"name",id:"name",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5",placeholder:"Nombre del espacio","onUpdate:modelValue":s[2]||(s[2]=o=>v.value=o)},null,512),[[B,v.value]])])]),Is],32)])])])):g("",!0),l.value.addSpace?(r(),d("div",Os,[e("div",Hs,[e("div",Ts,[e("div",{class:"flex items-center justify-between p-4 md:p-5 border-b rounded-t"},[Fs,e("button",{type:"button",class:"text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center","data-modal-toggle":"crud-modal",onClick:V},Rs)]),e("form",{class:"p-4 md:p-5",onSubmit:T(Z,["prevent"])},[e("div",Gs,[e("div",Ws,[l.value.message!==""?(r(),d("p",Js,[Ks,x(" "+f(l.value.message),1)])):g("",!0),l.value.loading.load?(r(),d("p",Qs,[Xs,x(" "+f(l.value.loading.message),1)])):g("",!0),Zs,D(e("input",{type:"text",name:"name",id:"name",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5",placeholder:"Nombre del espacio","onUpdate:modelValue":s[3]||(s[3]=o=>v.value=o)},null,512),[[B,v.value]]),y.value?g("",!0):(r(),d("div",eo,[to,e("div",so,[D(e("input",{type:"text",name:"sensor",id:"sensor",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 mr-2",placeholder:"Nombre del sensor","onUpdate:modelValue":s[4]||(s[4]=o=>p.value.name=o)},null,512),[[B,p.value.name]]),N(A,{name:"unit",elementos:j,onChange:O},null,8,["elementos"])]),e("div",oo,[D(e("input",{type:"text",name:"value",id:"value",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5",placeholder:"Valor de la unidad","onUpdate:modelValue":s[5]||(s[5]=o=>p.value.value=o)},null,512),[[B,p.value.value]])]),lo,e("div",ao,[D(e("input",{type:"text",name:"executor",id:"executor",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 mr-2",placeholder:"Nombre del ejecutor","onUpdate:modelValue":s[6]||(s[6]=o=>C.value.name=o)},null,512),[[B,C.value.name]]),N(A,{name:"executor",elementos:$,onChange:O},null,8,["elementos"])]),e("div",no,[N(A,{name:"stateExecutor",id:"stateExecutor",elementos:[{name:"Activo",value:1},{name:"Inactivo",value:0}],text:"Estado del ejecutor",onChange:O})])]))])]),e("div",io,[e("label",ro,[e("i",{class:W(["bx",y.value?"bxs-toggle-right":"bxs-toggle-left","bx-lg","cursor-pointer",y.value?"text-green-500":"text-red-500","rounded-full","transition-opacity duration-300 ease-in-out"]),style:{"vertical-align":"middle",opacity:"1"},title:"Estado del ejecutor",onClick:s[7]||(s[7]=o=>y.value=!y.value)},null,2),co])]),uo],32)])])])):g("",!0)])],64))}},_o=_e(mo,[["__scopeId","data-v-6040594d"]]);export{_o as default};
