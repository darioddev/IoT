import{r as E,l as R,m as M,v as le,b as c,c as u,t as h,g as _,F as A,j as z,d as e,k as G,f as g,p as V,e as $,q as re,s as ie,u as ce,i as O,x as de,h as H,y as x,z as ue,A as me,B as J}from"./index-HF2rM2gW.js";import{_ as ve}from"./buttonThemeComponet-C9pu6yze.js";import{g as B,h as N}from"./validations-3worHtu6.js";import{_ as xe}from"./_plugin-vue_export-helper-x3n3nnut.js";import"https://www.gstatic.com/firebasejs/9.6.2/firebase-app.js";import"https://www.gstatic.com/firebasejs/9.6.2/firebase-firestore.js";import"https://www.gstatic.com/firebasejs/9.6.2/firebase-auth.js";const he=["name","id"],pe={key:0,value:"",disabled:"",selected:""},fe=["value"],I={__name:"selectComponent",props:{name:{type:String,required:!0},elementos:{type:Array,required:!0},text:{type:String,required:!1,default:"Selecciona una opción"},selectedValue:{type:String,required:!1,default:""}},setup(m){const{name:p,elementos:d,text:l,selectedValue:n}=m,w=E("");return R(()=>n,y=>{w.value=y},{immediate:!0,deep:!0}),(y,S)=>M((c(),u("select",{name:m.name,id:m.name,class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5","onUpdate:modelValue":S[0]||(S[0]=f=>w.value=f)},[m.selectedValue?_("",!0):(c(),u("option",pe,h(m.text),1)),(c(!0),u(A,null,z(m.elementos,f=>(c(),u("option",{key:f.name,value:f.name},h(f.name),9,fe))),128))],8,he)),[[le,w.value]])}},be={key:0,id:"crud-modal",tabindex:"-1","aria-hidden":"true",class:"flex overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full"},ge={class:"relative p-4 w-full max-w-md max-h-full"},we={class:"relative bg-white rounded-lg shadow",id:"modal"},_e={class:"flex items-center justify-between p-4 md:p-5 border-b rounded-t"},ye={class:"text-lg font-semibold text-gray-900"},ke=e("svg",{class:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14"},[e("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})],-1),Se=e("span",{class:"sr-only"},"Close modal",-1),je=[ke,Se],Ce={class:"mb-4"},Ee={class:"mb-2"},$e={key:0,class:"text-sm font-bold text-red-600 text-center flex items-center justify-center"},Me=e("svg",{xmlns:"http://www.w3.org/2000/svg",x:"20px",y:"0px",width:"25",height:"25",viewBox:"0 0 48 48",class:""},[e("path",{fill:"#f44336",d:"M44,24c0,11.045-8.955,20-20,20S4,35.045,4,24S12.955,4,24,4S44,12.955,44,24z"}),e("path",{fill:"#fff",d:"M29.656,15.516l2.828,2.828l-14.14,14.14l-2.828-2.828L29.656,15.516z"}),e("path",{fill:"#fff",d:"M32.484,29.656l-2.828,2.828l-14.14-14.14l2.828-2.828L32.484,29.656z"})],-1),De={key:1,class:"text-sm font-bold text-blue-600 text-center flex items-center justify-center"},Ve=e("svg",{class:"animate-spin -ms-1 w-5 h-5 me-3",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})],-1),Be={class:"col-span-2 flex items-center justify-between"},Ne=["name","id","placeholder"],Ae={class:"col-span-2 flex items-center justify-between pt-2"},Ie={type:"submit",class:"text-white inline-flex items-center bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center"},ze=e("svg",{class:"me-1 -ms-1 w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"fill-rule":"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z","clip-rule":"evenodd"})],-1),F={__name:"modalComponent",props:{head:{type:String,required:!0},name:{type:String,required:!0},placeholder:{type:String,required:!1,default:""},elements:{type:Array,required:!0},state:{type:Array,required:!1,default:()=>[]},value:{type:Boolean,required:!1,default:!1},messageError:{type:String,required:!1,default:""},initialData:{type:Object,required:!1,default:()=>({})},isLoading:{type:Object,required:!1}},emits:["closeModal","handleSubmit"],setup(m,{emit:p}){const d=m,l=E({name:"",unit:"",value:"",executor:"",state:""}),n=p,w=()=>n("handleSubmit",l.value),y=()=>n("closeModal",l.value),S=r=>{d.state.length===0?l.value={...l.value,unit:r.target.value}:l.value={...l.value,executor:r.target.value}},f=r=>{l.value={...l.value,state:r.target.value}};return R(()=>d.initialData,r=>{l.value={...r}},{deep:!0}),(r,b)=>d.value?(c(),u("div",be,[e("div",ge,[e("div",we,[e("div",_e,[e("h3",ye,h(d.head),1),e("button",{type:"button",class:"text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center","data-modal-toggle":"crud-modal",onClick:y},je)]),e("form",{class:"p-4 md:p-5",onSubmit:G(w,["prevent"])},[e("div",Ce,[e("div",Ee,[d.messageError!==""?(c(),u("p",$e,[Me,g(" "+h(d.messageError),1)])):_("",!0),d.isLoading.load?(c(),u("p",De,[Ve,g(" "+h(d.isLoading.message),1)])):_("",!0)]),e("div",Be,[M(e("input",{type:"text",name:d.name,id:d.name,class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 mr-2",placeholder:m.placeholder,"onUpdate:modelValue":b[0]||(b[0]=a=>l.value.name=a)},null,8,Ne),[[V,l.value.name]]),$(I,{name:d.name,elementos:d.elements,onChange:S,selectedValue:l.value.unit||l.value.executor},null,8,["name","elementos","selectedValue"])]),e("div",Ae,[d.state.length===0?M((c(),u("input",{key:0,type:"text",name:"value",id:"value",class:"bg-gray-50 border border-gray-300 teaxt-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5",placeholder:"Valor de la unidad","onUpdate:modelValue":b[1]||(b[1]=a=>l.value.value=a)},null,512)),[[V,l.value.value]]):(c(),re(I,{key:1,name:d.name,elementos:d.state,onChange:f,selectedValue:l.value.state,text:"Estado del ejecutor"},null,8,["name","elementos","selectedValue"]))])]),e("button",Ie,[ze,g(" "+h(m.head),1)])],32)])])])):_("",!0)}},P=m=>new Promise(p=>{ie(m,d=>{p(d.docs.map(l=>({id:l.id,...l.data()})))})}),Y={unitName:"units",executorName:"executores",async getUnits(){return await P(this.unitName)},async getExecutors(){return await P(this.executorName)},getLength:m=>Object.keys(m).length,handleSelect:(m,p,d)=>{const l=d.target.selectedOptions[0].value;m[p]=l}},i=m=>(ue("data-v-835cc85b"),m=m(),me(),m),Le={class:"fixed inset-x-0 top-0 z-10 w-full px-4 py-1 bg-white shadow-md border-slate-500 transition duration-700 ease-out"},qe={class:"flex justify-between p-4"},Ue=i(()=>e("div",{class:"text-[2rem] leading-[3rem] tracking-tight font-bold text-black",id:"h1"},[g(" Bienvenido a "),e("span",{class:"text-blue-700"},"IoT")],-1)),Oe={class:"flex items-center space-x-4 text-lg font-semibold tracking-tight"},Te=i(()=>e("svg",{class:"w-6 h-6 text-black mx-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"{2}",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1)),He=i(()=>e("svg",{class:"w-6 h-6 text-black mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"{2}",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1)),Fe={class:"flex flex-col items-center justify-center w-full h-screen bg-gray-100"},Pe={key:0,class:"absolute top-0 left-0 w-full h-full flex items-center justify-center bg-white opacity-75"},Ye=i(()=>e("p",{class:"text-2xl font-bold text-gray-500"},"Cargando...",-1)),Re=[Ye],Ge={key:1},Je={class:"flex flex-col items-center justify-center w-full h-full"},Ke=i(()=>e("p",{class:"text-2xl font-bold text-gray-500"},"No tienes ningún espacio",-1)),Qe=i(()=>e("svg",{class:"w-6 h-6 text-black mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"{2}",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1)),We={key:2,class:"flex flex-col items-start justify-start h-screen pt-20 w-full"},Xe={class:"w-full"},Ze=i(()=>e("div",{class:"p-4"},[e("p",{class:"text-3xl font-bold text-gray-500"},"Tus espacios")],-1)),et={class:"flex flex-col justify-center w-ful mx-4"},tt={class:"w-full flex rounded-t-lg bg-blue-700 mt-1"},st={class:"text-2xl font-bold text-white p-2"},ot={class:"flex items-center p-1 containerDevice"},at={class:"text-base font-bold text-white mx-1 underline"},nt={class:"text-base font-bold text-white mx-1 underline"},lt=["onClick"],rt=i(()=>e("svg",{class:"w-6 h-6 text-white mr-2 mt-2 rounded-lg cursor-pointer hover:bg-sky-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",title:"Más información sobre el espacio"},[g(" > > "),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"{2}",d:"M19 5l-7 7-7-7"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"{2}",d:"M19 5l-7 7-7-7"})],-1)),it=[rt],ct={key:0},dt=J('<div class="flex flex-col items-center justify-center w-full p-2 bg-blue-100 content" data-v-835cc85b><p class="text-2xl font-bold text-gray-500" data-v-835cc85b>Sensores</p></div><div class="flex flex-row items-center justify-between w-full pl-4 bg-blue-600" data-v-835cc85b><div class="flex flex-row items-center justify-between w-full pl-4 bg-blue-600" data-v-835cc85b><div class="w-1/3" data-v-835cc85b><p class="text-base font-bold text-white mx-1" data-v-835cc85b>Nombre</p></div><div class="w-1/3" data-v-835cc85b><p class="text-base font-bold text-white mx-1" data-v-835cc85b>Unidad de medida</p></div><div class="w-1/3" data-v-835cc85b><p class="text-base font-bold text-white mx-1" data-v-835cc85b>Valor</p></div><div class="w-1/3" data-v-835cc85b><p class="text-base font-bold text-white mx-1" data-v-835cc85b></p></div></div></div>',2),ut={class:"w-1/3"},mt={class:"text-base font-medium text-white"},vt={class:"w-1/3 pl-2"},xt={class:"text-base font-medium text-white"},ht={class:"w-1/3 pl-2"},pt={class:"text-base font-medium text-white"},ft={class:"w-1/3"},bt={class:"flex flex-row item-center justify-end p-1 mr-20"},gt=["onClick"],wt=i(()=>e("i",{class:"bx bxs-rename"},null,-1)),_t=[wt],yt=["onClick"],kt=i(()=>e("i",{class:"bx bxs-trash"},null,-1)),St=[kt],jt=J('<div class="flex flex-col items-center justify-center w-full p-2 bg-blue-100 content" data-v-835cc85b><p class="text-2xl font-bold text-gray-500" data-v-835cc85b>Ejecutores</p></div><div class="flex flex-row items-center justify-between w-full pl-4 bg-blue-600" data-v-835cc85b><div class="flex flex-row items-center justify-between w-full pl-4 bg-blue-600" data-v-835cc85b><div class="w-1/3" data-v-835cc85b><p class="text-base font-bold text-white mx-1" data-v-835cc85b>Nombre</p></div><div class="w-1/3" data-v-835cc85b><p class="text-base font-bold text-white mx-1" data-v-835cc85b>Dispositivo</p></div><div class="w-1/3" data-v-835cc85b><p class="text-base font-bold text-white mx-1" data-v-835cc85b>Estado</p></div><div class="w-1/3" data-v-835cc85b><p class="text-base font-bold text-white mx-1" data-v-835cc85b></p></div></div></div>',2),Ct={class:"w-1/3"},Et={class:"text-base font-medium text-white"},$t={class:"w-1/3 pl-2"},Mt={class:"text-base font-medium text-white"},Dt={class:"w-1/3 pl-2"},Vt={class:"text-base font-medium text-white"},Bt={class:"w-1/3"},Nt={class:"flex flex-row item-center justify-end p-1 mr-20"},At=["onClick"],It=i(()=>e("i",{class:"bx bxs-rename"},null,-1)),zt=[It],Lt=["onClick"],qt=i(()=>e("i",{class:"bx bxs-trash"},null,-1)),Ut=[qt],Ot={class:"flex flex-row bg-blue-700 rounded-b-lg p-3"},Tt=["onClick","id"],Ht=i(()=>e("i",{class:"bx bx-radar bx-sm"},null,-1)),Ft=["onClick"],Pt=i(()=>e("i",{class:"bx bx-devices bx-sm"},null,-1)),Yt=["onClick"],Rt=i(()=>e("i",{class:"bx bxs-trash text-lg mr-1"},null,-1)),Gt={key:3,id:"crud-modal",tabindex:"-1","aria-hidden":"true",class:"flex overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full"},Jt={class:"relative p-4 w-full max-w-md max-h-full"},Kt={class:"relative bg-white rounded-lg shadow",id:"modal"},Qt=i(()=>e("h3",{class:"text-lg font-semibold text-gray-900"}," Crear un nuevo espacio ",-1)),Wt=i(()=>e("svg",{class:"w-3 h-3","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 14 14"},[e("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"})],-1)),Xt=i(()=>e("span",{class:"sr-only"},"Close modal",-1)),Zt=[Wt,Xt],es={class:"grid gap-4 mb-4 grid-cols-2"},ts={class:"col-span-2"},ss={key:0,class:"text-sm font-bold text-red-600 flex"},os=i(()=>e("svg",{xmlns:"http://www.w3.org/2000/svg",x:"20px",y:"0px",width:"25",height:"25",viewBox:"0 0 48 48",class:"pb-1"},[e("path",{fill:"#f44336",d:"M44,24c0,11.045-8.955,20-20,20S4,35.045,4,24S12.955,4,24,4S44,12.955,44,24z"}),e("path",{fill:"#fff",d:"M29.656,15.516l2.828,2.828l-14.14,14.14l-2.828-2.828L29.656,15.516z"}),e("path",{fill:"#fff",d:"M32.484,29.656l-2.828,2.828l-14.14-14.14l2.828-2.828L32.484,29.656z"})],-1)),as={key:1,class:"text-sm font-bold text-blue-600 flex"},ns=i(()=>e("svg",{class:"animate-spin -ml-1 mr-3 h-5 w-5 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})],-1)),ls=i(()=>e("label",{for:"name",class:"block mb-2 text-sm font-medwium text-gray-900"},[g("Name "),e("span",{class:"text-red-500"},"*")],-1)),rs=i(()=>e("label",{for:"sensor",class:"block mb-2 text-sm font-medium text-gray-900 p-1"},"Sensor",-1)),is={class:"col-span-2 flex items-center justify-between"},cs={class:"col-span-2 flex items-center justify-between pt-2"},ds=i(()=>e("label",{for:"executor",class:"block mb-2 text-sm font-medium text-gray-900 p-1"},"Ejecutor",-1)),us={class:"col-span-2 flex items-center"},ms={class:"col-span-2 flex items-center justify-between pt-2"},vs=i(()=>e("button",{type:"submit",class:"text-white inline-flex items-center bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center"},[e("svg",{class:"me-1 -ms-1 w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"fill-rule":"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z","clip-rule":"evenodd"})]),g(" Crear nuevo espacio ")],-1)),xs={__name:"dashboardView",setup(m){let p;const d=ce(),l=E(!1),n=O([]),w=O([]),y=O([]),S=E([]),f=E(""),r=E({name:"",unit:"",value:""}),b=E({name:"",executor:"",state:""}),a=E({id:-1,sensor:!1,executor:!1,addSpace:!1,message:"",editSpace:!1,loading:{load:!1,message:"Cargando..."}}),T=()=>{a.value.id=-1,f.value="",r.value={name:"",unit:"",value:""},b.value={name:"",executor:"",state:0}},j=()=>{a.value={id:-1,sensor:!1,executor:!1,addSpace:!1,message:"",loading:{load:!1,message:"Cargando..."}},T()},L=t=>{t!=null&&Object.keys(t).forEach(o=>{o!=="id"&&(t[o]="")}),j()},D=(t,o=-1)=>{a.value.id=o,a.value[t]=!a.value[t]},K=async()=>{try{if(!f.value.trim())throw new Error("El nombre del espacio no puede estar vacío");if(x.isExistSpace(n,f.value))throw new Error(`Ya existe un espacio con el nombre : ${f.value}`);const t=[{id:B(),...r.value}],o=[{id:B(),...b.value}];if(N(r.value)||N(b.value))throw new Error("Debes añadir al menos un sensor y un ejecutor");a.value.message="",a.value.loading={load:!0,message:"Añadiendo espacio..."},await new Promise(s=>setTimeout(s,300)),n.push({id:B(),name:f.value,sensores:t,ejecutores:o}),await x.updateDocument(p,{space:n}),j(),T()}catch(t){a.value.message=t.message}},Q=async t=>{try{const o=a.value.sensor?{id:B(),name:t.name,unit:t.unit,value:t.value}:{id:B(),name:t.name,executor:t.executor,state:t.state};if(console.log(t),a.value.id===-1)throw new Error("Debes seleccionar un espacio");if(N(o))throw new Error("Debes completar todos los campos");const s=x.findSpaceIndex(n,a.value.id);if(a.value.sensor&&x.isExistSensor(n,a.value.id,o.name))throw new Error(`Ya existe un sensor con el nombre : ${o.name}`);if(a.value.executor&&x.isExistExecutor(n,a.value.id,o.name))throw new Error(`Ya existe un ejecutor con el nombre : ${o.name}`);a.value.sensor&&(n[s].sensores.push({...o}),a.value.loading={load:!0,message:"Añadiendo sensor..."}),a.value.executor&&(n[s].ejecutores.push({...o}),a.value.loading={load:!0,message:"Añadiendo ejecutor..."}),await new Promise(C=>setTimeout(C,300)),await x.updateDocument(p,{space:n}),L(t)}catch(o){a.value.message=o.message}},W=(t,o)=>{const s=x.findSensor(n,t,o);r.value={...s.data},D("editSpace")},X=(t,o)=>{const s=x.findExecutor(n,t,o);b.value={...s.data},D("editSpace")},Z=async t=>{try{const o=x.findSpaceIndex(n,t);confirm(`¿Estás seguro de eliminar el espacio ${n[o].name}?`)&&(n.splice(o,1),await x.updateDocument(p,{space:n}),j())}catch(o){console.error(o)}},ee=async(t,o)=>{try{const s=x.findSensor(n,t,o);confirm(`¿Estás seguro de eliminar el sensor ${s.data.name} del espacio ${n[s.indexSpace].name}?`)&&(n[s.indexSpace].sensores.splice(s.executorIndex,1),await x.updateDocument(p,{space:n}),j())}catch(s){console.error(s)}},te=async(t,o)=>{try{const s=x.findExecutor(n,t,o);confirm(`¿Estás seguro de eliminar el ejecutor ${s.data.name} del espacio ${n[s.indexSpace].name}?`)&&(n[s.indexSpace].ejecutores.splice(s.executorIndex,1),await x.updateDocument(p,{space:n}),j())}catch(s){console.error(s)}},se=async t=>{try{if(N(t))throw new Error("Debes completar todos los campos");const{indexSpace:o,executorIndex:s}=x.findExecutor(n,a.value.id,t.id);if(t.name!==n[o].ejecutores[s].name&&x.isExistExecutor(n,a.value.id,t.name))throw new Error(`Ya existe un ejecutor con el nombre : ${t.name}`);a.value.loading.load={load:!0,message:"Actualizando ejecutor..."},await new Promise(C=>setTimeout(C,200)),n[o].ejecutores[s]={...t},await x.updateDocument(p,{space:n}),j()}catch(o){a.value.message=o.message}},oe=async t=>{try{if(N(t))throw new Error("Debes completar todos los campos");const{indexSpace:o,sensorIndex:s}=x.findSensor(n,a.value.id,t.id);if(t.name!==n[o].sensores[s].name&&x.isExistSensor(n,a.value.id,t.name))throw new Error(`Ya existe un sensor con el nombre : ${t.name}`);a.value.loading={load:!0,message:"Actualizando sensor..."},await new Promise(C=>setTimeout(C,200)),n[o].sensores[s]={...t},await x.updateDocument(p,{space:n}),j()}catch(o){a.value.message=o.message}},ae=t=>{r.value.name.trim()?oe(t):se(t)},q=t=>{const o=t.target.selectedOptions[0].value;t.target.id==="unit"&&(r.value.unit=o),t.target.id==="executor"&&(b.value.executor=o),t.target.id==="stateExecutor"&&(b.value.state=o)},ne=async()=>{try{confirm("¿Estás seguro de cerrar sesión?")&&(await H.logout(),d.replace({name:"home"}))}catch(t){console.log(t)}};return de(async()=>{l.value=!0;try{const{uid:t}=await H.getAuth();p=t;const o=async()=>{(await Y.getUnits()).map(k=>w.push(k))},s=async()=>{(await Y.getExecutors()).forEach(k=>y.push(k))};await(async()=>{const{space:v}=await x.getDocument(t);v.forEach(k=>n.push(k))})(),await o(),await s()}catch(t){console.error(t)}finally{l.value=!1}}),(t,o)=>(c(),u(A,null,[e("nav",Le,[e("div",qe,[Ue,e("div",Oe,[e("div",null,[e("button",{class:"flex items-center px-6 py-2 text-white transition duration-500 ease-out bg-blue-700 rounded-lg hover:bg-blue-800 hover:ease-in hover:underline",type:"button",onClick:o[0]||(o[0]=s=>D("addSpace"))},[Te,g(" Añadir un nuevo espacio ")])]),e("button",{class:"flex items-center px-6 py-2 mx-2 text-black transition duration-700 ease-out bg-white border border-black rounded-lg hover:bg-black hover:border hover:text-white",type:"button",onClick:ne},[He,g(" Cerrar sesión ")])])])]),e("main",Fe,[$(ve,{class:"fixed top-6 right-4 p-2 bg-gray-200 rounded-full mt-20"}),l.value?(c(),u("div",Pe,Re)):_("",!0),n.length===0&&!l.value?(c(),u("div",Ge,[e("div",Je,[Ke,e("button",{class:"flex items-center px-6 py-2 mt-4 text-white transition duration-500 ease-out bg-blue-700 rounded-lg hover:bg-blue-800 hover:ease-in hover:underline",type:"button",onClick:o[1]||(o[1]=s=>D("addSpace"))},[Qe,g(" Añadir un nuevo espacio ")])])])):!l.value&&n.length!==0?(c(),u("div",We,[e("div",Xe,[Ze,e("div",et,[(c(!0),u(A,null,z(n,(s,C)=>(c(),u("div",{key:s.name,class:"mx-1"},[e("div",tt,[e("div",null,[e("p",st,h(s.name.trim().toLowerCase()),1),e("div",ot,[e("p",at,"Sensores: "+h(s.sensores.length),1),e("p",nt,"Ejecutores: "+h(s.ejecutores.length),1)])]),e("div",{class:"flex flex-col items-end w-1/2 ml-auto p-5",onClick:v=>S.value[s.name]=!S.value[s.name]},it,8,lt)]),S.value[s.name]?(c(),u("div",ct,[dt,(c(!0),u(A,null,z(s.sensores,(v,k)=>(c(),u("div",{key:v.id,class:"w-full flex flex-row bg-blue-600 rounder-lg pl-8"},[e("div",ut,[e("p",mt,h(k+1)+" - "+h(v.name),1)]),e("div",vt,[e("p",xt,h(v.unit),1)]),e("div",ht,[e("p",pt,h(v.value),1)]),e("div",ft,[e("div",bt,[e("button",{class:"flex items-center px-6 py-2 mx-2 text-white transition duration-500 ease-out bg-blue-700 rounded-lg hover:bg-blue-800 hover:ease-in hover:underline",type:"button",onClick:U=>{W(s.id,v.id),a.value.id=s.id}},_t,8,gt),e("button",{class:"flex items-center px-3 py-2 mx-2 text-white transition duration-500 ease-out bg-red-700 rounded-lg hover:bg-red-800 hover:ease-in hover:underline",type:"button",onClick:U=>ee(s.id,v.id)},St,8,yt)])])]))),128)),e("div",null,[jt,(c(!0),u(A,null,z(s.ejecutores,(v,k)=>(c(),u("div",{key:v.id,class:"w-full flex flex-row bg-blue-600 rounder-lg pl-8 pb-2"},[e("div",Ct,[e("p",Et,h(k+1)+" - "+h(v.name),1)]),e("div",$t,[e("p",Mt,h(v.executor),1)]),e("div",Dt,[e("p",Vt,h(v.state),1)]),e("div",Bt,[e("div",Nt,[e("button",{class:"flex items-center px-6 py-2 mx-2 text-white transition duration-500 ease-out bg-blue-700 rounded-lg hover:bg-blue-800 hover:ease-in hover:underline",type:"button",onClick:U=>{X(s.id,v.id),a.value.id=s.id}},zt,8,At),e("button",{class:"flex items-center px-3 py-2 mx-2 text-white transition duration-500 ease-out bg-red-700 rounded-lg hover:bg-red-800 hover:ease-in hover:underline",type:"button",onClick:U=>te(s.id,v.id)},Ut,8,Lt)])])]))),128))]),e("div",null,[e("div",Ot,[e("button",{class:"flex items-center px-4 py-2 mx-2 text-white transition duration-500 ease-out bg-blue-700 rounded-lg hover:bg-blue-800 hover:ease-in hover:underline",type:"button",onClick:v=>D("sensor",s.id),id:C},[Ht,g(" Añadir un nuevo sensor ")],8,Tt),e("button",{class:"flex items-center px-4 py-2 mx-2 text-white transition duration-500 ease-out bg-blue-700 rounded-lg hover:bg-blue-800 hover:ease-in hover:underline",type:"button",onClick:v=>D("executor",s.id)},[Pt,g(" Añadir un nuevo ejecutor ")],8,Ft),e("button",{class:"flex items-center px-4 py-2 mx-2 text-white transition duration-500 ease-out bg-red-700 rounded-lg hover:bg-red-800 hover:ease-in hover:underline",type:"button",onClick:v=>Z(s.id)},[Rt,g(" Eliminar espacio ")],8,Yt)])])])):_("",!0)]))),128))])])])):_("",!0),$(F,{head:`Añadir un nuevo ${a.value.sensor?"sensor":"ejecutor"}`,name:a.value.sensor?"sensor":"executor",placeholder:a.value.sensor?"Nombre del sensor":"Nombre del ejecutor",elements:a.value.sensor?w:y,state:a.value.executor?[{name:"Activo",value:1},{name:"Inactivo",value:0}]:[],value:a.value[a.value.sensor?"sensor":"executor"],onCloseModal:L,onHandleSubmit:Q,messageError:a.value.message,isLoading:a.value.loading,initialData:a.value.sensor?r.value:b.value},null,8,["head","name","placeholder","elements","state","value","messageError","isLoading","initialData"]),$(F,{head:`Modificar ${r.value.name.trim()?"sensor":"ejecutor"} ${r.value.name}`,name:r.value.name.trim()?"sensor":"ejecutor",placeholder:`Nombre del ${r.value.name.trim()?"sensor":"ejecutor"}`,elements:r.value.name.trim()?w:y,state:r.value.name.trim()?[]:[{name:"Activo",value:1},{name:"Inactivo",value:0}],value:a.value.editSpace,onCloseModal:L,onHandleSubmit:ae,messageError:a.value.message,isLoading:a.value.loading,initialData:r.value.name.trim()?r.value:b.value},null,8,["head","name","placeholder","elements","state","value","messageError","isLoading","initialData"]),a.value.addSpace?(c(),u("div",Gt,[e("div",Jt,[e("div",Kt,[e("div",{class:"flex items-center justify-between p-4 md:p-5 border-b rounded-t"},[Qt,e("button",{type:"button",class:"text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center","data-modal-toggle":"crud-modal",onClick:j},Zt)]),e("form",{class:"p-4 md:p-5",onSubmit:G(K,["prevent"])},[e("div",es,[e("div",ts,[a.value.message!==""?(c(),u("p",ss,[os,g(" "+h(a.value.message),1)])):_("",!0),a.value.loading.load?(c(),u("p",as,[ns,g(" "+h(a.value.loading.message),1)])):_("",!0),ls,M(e("input",{type:"text",name:"name",id:"name",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5",placeholder:"Nombre del espacio","onUpdate:modelValue":o[2]||(o[2]=s=>f.value=s)},null,512),[[V,f.value]]),rs,e("div",is,[M(e("input",{type:"text",name:"sensor",id:"sensor",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 mr-2",placeholder:"Nombre del sensor","onUpdate:modelValue":o[3]||(o[3]=s=>r.value.name=s)},null,512),[[V,r.value.name]]),$(I,{name:"unit",elementos:w,onChange:q},null,8,["elementos"])]),e("div",cs,[M(e("input",{type:"text",name:"value",id:"value",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5",placeholder:"Valor de la unidad","onUpdate:modelValue":o[4]||(o[4]=s=>r.value.value=s)},null,512),[[V,r.value.value]])]),ds,e("div",us,[M(e("input",{type:"text",name:"executor",id:"executor",class:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-primary-600 focus:border-primary-600 block w-full p-2.5 mr-2",placeholder:"Nombre del ejecutor","onUpdate:modelValue":o[5]||(o[5]=s=>b.value.name=s)},null,512),[[V,b.value.name]]),$(I,{name:"executor",elementos:y,onChange:q},null,8,["elementos"])]),e("div",ms,[$(I,{name:"stateExecutor",id:"stateExecutor",elementos:[{name:"Activo",value:1},{name:"Inactivo",value:0}],text:"Estado del ejecutor",onChange:q})])])]),vs],32)])])])):_("",!0)])],64))}},ys=xe(xs,[["__scopeId","data-v-835cc85b"]]);export{ys as default};
